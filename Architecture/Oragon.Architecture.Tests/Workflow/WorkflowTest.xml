<?xml version="1.0" encoding="utf-8" ?>
<objects
	xmlns="http://www.springframework.net"
	xmlns:wcf="http://www.springframework.net/wcf"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:aop="http://www.springframework.net/aop"
	xmlns:nv="http://www.springframework.net/nvelocity"
	>



	<object name="ConnectionFactory_Admin" type="Spring.Messaging.Amqp.Rabbit.Connection.CachingConnectionFactory, Spring.Messaging.Amqp.Rabbit">
		<property name="Host" value="oragonserver02" />
		<property name="Port" value="5672" />
		<property name="VirtualHost" value="Workflow" />
		<property name="UserName" value="wcfUser" />
		<property name="Password" value="wcfPassword" />
	</object>

	<object name="ConnectionFactory_User" type="Spring.Messaging.Amqp.Rabbit.Connection.CachingConnectionFactory, Spring.Messaging.Amqp.Rabbit">
		<property name="Host" value="oragonserver02" />
		<property name="Port" value="5672" />
		<property name="VirtualHost" value="Workflow" />
		<property name="UserName" value="wcfUser" />
		<property name="Password" value="wcfPassword" />
	</object>

	<object name="RabbitTemplate" type="Spring.Messaging.Amqp.Rabbit.Core.RabbitTemplate, Spring.Messaging.Amqp.Rabbit">
		<property name="ConnectionFactory" ref="ConnectionFactory_User" />
		<property name="ChannelTransacted" value="true" />
		<property name="Exchange" value="WFIngestion_DefaultExchange1"/>
		<property name="MessageConverter" ref="JsonMessageConverter" />
	</object>



	<object name="JsonMessageConverter" type="Spring.Messaging.Amqp.Support.Converter.JsonMessageConverter, Spring.Messaging.Amqp" />

	<object name="StateMachine" type="Oragon.Architecture.Workflow.QueuedWorkFlow.QueuedStateMachine, Oragon.Architecture">
		<property name="UserAmqpConnection" ref="ConnectionFactory_User" />
		<property name="AmqpAdmin">
			<object type="Spring.Messaging.Amqp.Rabbit.Core.RabbitAdmin, Spring.Messaging.Amqp.Rabbit">
				<constructor-arg name="connectionFactory" ref="ConnectionFactory_Admin" />
				<property name="AutoStartup" value="false" />
			</object>
		</property>

		<property name="AmqpQueuePrefix" value="WFIngestion_" />
		<property name="AmqpExchangePrefix" value="WFIngestion_" />
		<property name="Transitions">
			<list element-type="Oragon.Architecture.Workflow.QueuedWorkFlow.QueuedTransition, Oragon.Architecture">

				<object type="Oragon.Architecture.Workflow.QueuedWorkFlow.QueuedTransition, Oragon.Architecture">
					<property name="Origin" value="PacoteEntregue" />
					<property name="Destination" value="PacoteMovido" />
					<property name="LogicalQueueName" value="ToDownload.Queue" />
					<property name="ExchangeName" value="DefaultExchange1" />
					<property name="ConcurrentConsumers" value="1" />
					<property name="Service" >
						<object type="Oragon.Architecture.Tests.Workflow.WorkflowTestHandler, Oragon.Architecture.Tests">
							<property name="Message"	 value="state:PacoteEntregue -> state:PacoteMovido" />
						</object>
					</property>
					<property name="ServiceMethod" value="Process" />
				</object>

				<object type="Oragon.Architecture.Workflow.QueuedWorkFlow.QueuedTransition, Oragon.Architecture">
					<property name="Origin" value="PacoteMovido" />
					<property name="Destination" value="MetadadoArmazenado" />
					<property name="LogicalQueueName" value="ToTrack.Queue" />
					<property name="ExchangeName" value="DefaultExchange1" />
					<property name="ConcurrentConsumers" value="1" />
					<property name="Service" >
						<object type="Oragon.Architecture.Tests.Workflow.WorkflowTestHandler, Oragon.Architecture.Tests">
							<property name="Message"	 value="state:PacoteMovido -> state:MetadadoArmazenado" />
						</object>
					</property>
					<property name="ServiceMethod" value="Process" />
				</object>

				<object type="Oragon.Architecture.Workflow.QueuedWorkFlow.QueuedTransition, Oragon.Architecture">
					<property name="Origin" value="MetadadoArmazenado" />
					<property name="Destination" value="MetadadoIngerido" />
					<property name="LogicalQueueName" value="ToIngest.Queue" />
					<property name="ExchangeName" value="DefaultExchange1" />
					<property name="ConcurrentConsumers" value="1" />
					<property name="Service" >
						<object type="Oragon.Architecture.Tests.Workflow.WorkflowTestHandler, Oragon.Architecture.Tests">
							<property name="Message"	 value="state:MetadadoArmazenado -> state:MetadadoIngerido_" />
						</object>
					</property>
					<property name="ServiceMethod" value="Process" />
				</object>

				<object type="Oragon.Architecture.Workflow.QueuedWorkFlow.QueuedTransition, Oragon.Architecture">
					<property name="Origin" value="MetadadoIngerido" />
					<property name="Destination" value="NotificacoesEnviadas" />
					<property name="LogicalQueueName" value="ToNotify.Queue" />
					<property name="ExchangeName" value="DefaultExchange2" />
					<property name="ConcurrentConsumers" value="1" />
					<property name="Service" >
						<object type="Oragon.Architecture.Tests.Workflow.WorkflowTestHandler, Oragon.Architecture.Tests">
							<property name="Message"	 value="state:MetadadoIngerido -> state:NotificacoesEnviadas" />
						</object>
					</property>
					<property name="ServiceMethod" value="Process" />
				</object>

			</list>
		</property>
	</object>



</objects>